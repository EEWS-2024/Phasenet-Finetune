2025-06-06 10:26:07.936877: E external/local_xla/xla/stream_executor/cuda/cuda_dnn.cc:9261] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
2025-06-06 10:26:07.936915: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:607] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
2025-06-06 10:26:07.938384: E external/local_xla/xla/stream_executor/cuda/cuda_blas.cc:1515] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
2025-06-06 10:26:09.126567: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
2025-06-06 10:26:13.182185: W tensorflow/core/common_runtime/gpu/gpu_bfc_allocator.cc:47] Overriding orig_value setting because the TF_FORCE_GPU_ALLOW_GROWTH environment variable is set. Original config value was 0.
PhaseNet Indonesia Testing - Sliding Window 3000
============================================================
Test directory: ../augmentasi-data-phasenet-full/dataset_phasenet_aug/npz_padded
Test list: ../augmentasi-data-phasenet-full/dataset_phasenet_aug/padded_valid_list.csv
Model directory: model_indonesia/finetuned/sliding3000_250606-101559
Output directory: model_indonesia/finetuned/sliding3000_250606-101559/test_results
Batch size: 2
Min probability: 0.1
============================================================
Indonesia Sliding Test DataReader initialized:
  Window length: 3000 samples (30.0 seconds)
  Total test windows: 1030
Test dataset loaded: 103 files
Sliding window config: 3000 samples, 3000 step
Using provided model directory: model_indonesia/finetuned/sliding3000_250606-101559
Using model directory: model_indonesia/finetuned/sliding3000_250606-101559
Loaded config: {'X_shape': [3000, 1, 3], 'Y_shape': [3000, 1, 3], 'batch_size': 256, 'class_weights': [1.0, 1.0, 1.0], 'decay_rate': 0.98, 'decay_step': 10, 'depths': 5, 'dilation_rate': [1, 1], 'drop_rate': 0.05, 'dt': 0.01, 'epochs': 3, 'filters_root': 8, 'kernel_size': [7, 1], 'learning_rate': 5e-05, 'loss_type': 'cross_entropy', 'momentum': 0.9, 'n_channel': 3, 'n_class': 3, 'optimizer': 'adam', 'pool_size': [4, 1], 'sampling_rate': 100, 'save_interval': 10, 'summary': True, 'use_batch_norm': True, 'use_dropout': True, 'weight_decay': 0.0001}
Loading model from: model_indonesia/finetuned/sliding3000_250606-101559/final_model.ckpt
Starting testing with sliding window 3000 strategy...
Detection thresholds: 0.10 / 0.20 / 0.30
Debug - pred_batch shape: (2, 3000, 1, 3)
Debug - preds shape: (3000, 1, 3)
Debug - preds after squeeze: (3000, 3)
Debug - P prob range: 0.000000 to 0.000000
Debug - S prob range: 0.000000 to 0.000000
Debug - Background prob range: 1.000000 to 1.000000
Debug - Sum of all probs (should be ~1): 1.000000
Debug - pred_batch shape: (2, 3000, 1, 3)
Debug - preds shape: (3000, 1, 3)
Debug - preds after squeeze: (3000, 3)
Debug - P prob range: 0.000000 to 0.000000
Debug - S prob range: 0.000000 to 0.000000
Debug - Background prob range: 1.000000 to 1.000000
Debug - Sum of all probs (should be ~1): 1.000000
Batch 50: 100 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Batch 100: 200 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Batch 150: 300 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Batch 200: 400 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Batch 250: 500 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Batch 300: 600 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Batch 350: 700 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Batch 400: 800 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Batch 450: 900 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Batch 500: 1000 windows | P: 0.0% | S: 0.0% | PS: 0.0%
   Avg Prob - P_max: 0.000, S_max: 0.000
Testing completed. Processed 1030 sliding windows.

SLIDING WINDOW TESTING RESULTS:
   Total windows tested: 1030
   P-wave detection rate: 0.0%
   S-wave detection rate: 0.0%
   Both P&S detection rate: 0.0%

PROBABILITY STATISTICS:
   P-wave prob - Mean: 0.000, Max: 0.000
   S-wave prob - Mean: 0.000, Max: 0.000
Results saved to: model_indonesia/finetuned/sliding3000_250606-101559/test_results/sliding_window_results.csv
Performance plots saved to: model_indonesia/finetuned/sliding3000_250606-101559/test_results/sliding_window_performance.png

Testing completed in 18.3 seconds
Successfully tested 1030 sliding windows
